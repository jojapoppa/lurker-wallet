name: lurker-wallet
about: Lurker Wallet — Pure RandomX + Yggdrasil + Slatepack
author: Lurker Developers

watch:
  about: Watch for payments over the Yggdrasil mesh (CEX-friendly)
  args:
    - node:
        help: Node URL (e.g. tcp://[200:1234::1]:3413)
        takes_value: true
    - pubkey:
        help: Public key(s) to watch (hex)
        multiple: true
        required: true

args:
  - testnet:
      help: Run against Lurker Testnet
      long: testnet
      takes_value: false
  - usernet:
      help: Run as local-only network (no outbound connections)
      long: usernet
      takes_value: false
  - pass:
      help: Wallet password
      short: p
      long: pass
      takes_value: true
  - account:
      help: Wallet account to use
      short: a
      long: account
      takes_value: true
      default_value: default
  - top_level_dir:
      help: Wallet data directory (location of lurker-wallet.toml)
      short: t
      long: top_level_dir
      takes_value: true
  - show_spent:
      help: Show spent outputs
      short: s
      long: show_spent
      takes_value: false
  - api_server_address:
      help: Node API address for input checking and tx posting
      short: r
      long: api_server_address
      takes_value: true

subcommands:
  - cli:
      about: Interactive CLI mode (EXPERIMENTAL)

  - account:
      about: List accounts or create new one
      args:
        - create:
            help: Create new account with given name
            short: c
            long: create
            takes_value: true

  - rewind_hash:
      about: Show wallet rewind hash

  - scan_rewind_hash:
      about: Scan chain using a view wallet's rewind hash
      args:
        - rewind_hash:
            help: Rewind hash to scan
            index: 1
        - start_height:
            help: Start scanning from this height
            short: h
            long: start_height
            takes_value: true
        - backwards_from_tip:
            help: Scan N blocks back from tip
            short: b
            long: backwards_from_tip
            takes_value: true

  - listen:
      about: Start wallet listener (receive transactions)
      args:
        - port:
            help: Port to listen on
            short: l
            long: port
            takes_value: true

  - owner_api:
      about: Start Owner API server
      args:
        - port:
            help: Owner API port
            short: l
            long: port
            takes_value: true
        - run_foreign:
            help: Also start Foreign API
            long: run_foreign
            takes_value: false

  - send:
      about: Send coins via Slatepack
      args:
        - amount:
            help: Amount to send (e.g. 12.34). Use 'max' for all spendable
            index: 1
        - minimum_confirmations:
            help: Minimum confirmations required
            short: c
            long: min_conf
            default_value: "10"
            takes_value: true
        - selection_strategy:
            help: Output selection: 'all' or 'smallest'
            short: s
            long: selection
            possible_values: [all, smallest]
            default_value: smallest
            takes_value: true
        - estimate_selection_strategies:
            help: Show all possible selection strategies
            short: e
            long: estimate-selection
        - late_lock:
            help: EXPERIMENTAL — Lock outputs only at finalize
            short: l
            long: late-lock
        - change_outputs:
            help: Number of change outputs (testing)
            short: o
            long: change_outputs
            default_value: "1"
            takes_value: true
        - dest:
            help: Recipient Slatepack address
            short: d
            long: dest
            takes_value: true
        - no_payment_proof:
            help: Don't request payment proof
            short: n
            long: no_payment_proof
        - stored_tx:
            help: Use stored unconfirmed tx
            short: t
            long: stored_tx
            takes_value: true
        - ttl_blocks:
            help: Transaction expires after N blocks
            short: b
            long: ttl_blocks
            takes_value: true
        - outfile:
            help: Custom output file
            short: u
            long: outfile
            takes_value: true
        - slatepack_qr:
            help: Show as QR code
            short: q
            long: slatepack_qr
        - amount_includes_fee:
            help: Amount includes fee (recipient gets amount - fee)
            long: amount_includes_fee

  - receive:
      about: Receive a transaction from a Slatepack
      args:
        - input:
            help: Input Slatepack file
            short: i
            long: input
            takes_value: true
        - outfile:
            help: Output file override
            short: u
            long: outfile
            takes_value: true
        - slatepack_qr:
            help: Show as QR code
            short: q
            long: slatepack_qr

  - finalize:
      about: Finalize a transaction
      args:
        - input:
            help: Input Slatepack file
            short: i
            long: input
            takes_value: true
        - nopost:
            help: Don't post to chain
            short: n
            long: nopost
        - outfile:
            help: Output file override
            short: u
            long: outfile
            takes_value: true
        - slatepack_qr:
            help: Show as QR code
            short: q
            long: slatepack_qr

  - invoice:
      about: Create invoice transaction
      args:
        - amount:
            help: Amount to invoice
            index: 1
        - dest:
            help: Payer's Slatepack address
            short: d
            long: dest
            takes_value: true
        - outfile:
            help: Output file override
            short: u
            long: outfile
            takes_value: true
        - slatepack_qr:
            help: Show as QR code
            short: q
            long: slatepack_qr

  - pay:
      about: Pay an invoice
      args:
        - minimum_confirmations:
            help: Minimum confirmations
            short: c
            long: min_conf
            default_value: "10"
            takes_value: true
        - selection_strategy:
            help: Output selection strategy
            short: s
            long: selection
            possible_values: [all, smallest]
            default_value: smallest
            takes_value: true
        - estimate_selection_strategies:
            help: Show all strategies
            short: e
            long: estimate-selection
        - dest:
            help: Override invoice sender address
            short: d
            long: dest
            takes_value: true
        - input:
            help: Invoice Slatepack file
            short: i
            long: input
            takes_value: true
        - ttl_blocks:
            help: Transaction TTL
            short: b
            long: ttl_blocks
            takes_value: true
        - outfile:
            help: Output file override
            short: u
            long: outfile
            takes_value: true
        - slatepack_qr:
            help: Show as QR code
            short: q
            long: slatepack_qr

  - outputs:
      about: Show wallet outputs

  - txs:
      about: Show transactions
      args:
        - id:
            help: Transaction ID
            short: i
            long: id
            takes_value: true
        - txid:
            help: Transaction UUID
            short: t
            long: txid
            takes_value: true
        - count:
            help: Max transactions to show
            short: c
            long: count
            takes_value: true

  - post:
      about: Post transaction to chain
      args:
        - input:
            help: Input Slatepack file
            short: i
            long: input
            takes_value: true

  - repost:
      about: Repost or dump stored transaction
      args:
        - id:
            help: Transaction ID
            short: i
            long: id
            takes_value: true
        - dumpfile:
            help: Dump to file instead of posting
            short: m
            long: dumpfile
            takes_value: true

  - cancel:
      about: Cancel transaction
      args:
        - id:
            help: Transaction ID
            short: i
            long: id
            takes_value: true
        - txid:
            help: Transaction UUID
            short: t
            long: txid
            takes_value: true

  - info:
      about: Show wallet summary
      args:
        - minimum_confirmations:
            help: Minimum confirmations
            short: c
            long: min_conf
            default_value: "10"
            takes_value: true

  - init:
      about: Create new wallet
      args:
        - here:
            help: Create wallet in current directory
            short: h
            long: here
        - short_wordlist:
            help: Use 12-word seed
            short: s
            long: short_wordlist
        - recover:
            help: Recover from seed
            short: r
            long: recover

  - recover:
      about: Show recovery phrase

  - address:
      about: Show Slatepack address

  - scan:
      about: Repair wallet outputs
      args:
        - delete_unconfirmed:
            help: Delete unconfirmed outputs
            short: d
            long: delete_unconfirmed
        - start_height:
            help: Start scan from height
            short: h
            long: start_height
            takes_value: true
        - backwards_from_tip:
            help: Scan N blocks back from tip
            short: b
            long: backwards_from_tip
            takes_value: true

  - export_proof:
      about: Export payment proof
      args:
        - output:
            help: Output file
            index: 1
        - id:
            help: Transaction ID
            short: i
            long: id
            takes_value: true
        - txid:
            help: Transaction UUID
            short: t
            long: txid
            takes_value: true

  - verify_proof:
      about: Verify payment proof
      args:
        - input:
            help: Proof file
            index: 1
